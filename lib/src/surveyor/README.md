This code is copied from https://github.com/pq/surveyor.

TODO: reference the package, when it gets published,
